---
title: "HID Attacks"
date: 2019-10-25T14:31:47-04:00
draft: false
---

Recently I learned about Human Interface Device (HID) attacks. Most likely you’ve been warned about inserting an unknown USB device into your computer. [Mr. Robot](https://en.wikipedia.org/wiki/Mr._Robot) even featured an episode where they hack a computer by leaving a conspicuous USB lying around, baiting the target into putting it in their computer. But, I wondered, “Is this really possible?” I know you can have scripts or executables that automatically run when a USB is plugged in, but most modern operating systems will automatically quarantine this activity, asking for admin input before running this. Thus, this didn’t seem to be a realistic vector of attack to me. However, upon further research, I learned HID attacks exploit the built in trust model most operating systems use for human input. While in the past keyboards, mice and other human interface devices used specific connectors, nowadays—in the interest of convenience and standardization—most input devices use USB. HID attacks pretend to be keyboards, running scripts by emulating keystrokes, relying on the OS’s implicit trust of these keystrokes to run automatically with no checks or prompts. 

# USB Rubber Ducky

In order to better understand these attacks, and have some fun messing around with them, I ordered myself a [USB Rubber Ducky](https://shop.hak5.org/products/usb-rubber-ducky-deluxe). The USB Rubber Ducky looks like a standard flash drive, but inside, it is anything but. The Ducky features a type A USB connector, connected to a board with a 60 MHz 32-bit CPU. The board also has a slot for a Micro SD card, which is meant to hold the scripts you want the USB to run. Commands for the Ducky are written in DuckyScript, a basic procedural language for defining interactions with the OS. DuckyScript can also be used to dynamically write other scripts, such as visual basic scripts for windows, to easily launch and run complex workflows. DuckyScript compiles down to an inject.bin file, which must be placed in the root directory of the SD card. There are numerous DuckyScript compilers available for all languages, but personally I used an [online compiler](https://ducktoolkit.com/encode). The processor on the Ducky will then execute this inject.bin, translating its commands into keyboard input.

The USB Rubber Ducky comes with the various parts each packaged separately. The assembly of The Ducky is pretty straightforward. The Ducky also comes with a nice guide explaining how to use it. The one issue I experienced with The Ducky is the USB casing not correctly fitting and closing around the internals. After contacting Hak5, they told me this is a manufacturing defect that has started to happen recently. I was issued a replacement for free, but this replacement also had the same issue. Finally, they linked me to a [guide](https://docs.hak5.org/hc/en-us/articles/360034798193) on how to fix the case so that it can be used. This worked perfectly and I was able to carry on with my exploration.

For my USB Rubber Ducky experiment, I went with something silly and whimsical: a script that opens up a full screen Rick-Roll on the target machine. However, there are much more malicious attacks possible as well. I’ve seen some that are able to open up reverse shells to the target machine, and others that are able to create and load background scripts onto the computer. In my personal opinion, the most effective use of this attack seems to be as set up for a phishing scheme; for example, by either creating a fake log in GUI, or updating the target’s hosts file to redirect them at malicious domains. You can find a lot of premade ducky scripts [here](https://github.com/hak5darren/USB-Rubber-Ducky/wiki/Payloads).

# The Future of HID Attacks

We’ve established that HID attacks can work, and can be very sneaky, but at this point I think many people are learning not to plug in random flash drives into their computer. So, what is the next vector to execute these attacks? Turns out, it’s USB cables! Recently I saw a [post](https://mg.lol/blog/badusb-cables/) by security researcher MG, who came up with what he calls the “BadUSB cable”. This cable acts as a normal charging cable, but much like the USB Rubber Ducky, it has an embedded processor that allows it to also act as a human interface device. With the trend towards USB type C cables for almost all functionality, USB-C cables will become more prolific. USB-C cables for charging, connecting, and screen-sharing could be very common in conference rooms, libraries, or other public locations, and it should be incredibly easy to switch these out for “BadUSB” cables.

In conclusion, HID attacks are very real and super cool. They can facilitate a variety of different attacks. While most people are wary of random USB drives lying around, most people seem to trust public cables, thus this is the direction these attacks are evolving in. So, in the future, be wary of public cables, they may be more than meets the eye!

